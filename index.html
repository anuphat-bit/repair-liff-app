<!DOCTYPE html>
<html>
<head>
  <title>LIFF Debug</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
  <h1>หน้าทดสอบระบบ LIFF</h1>
  <p>สถานะปัจจุบัน: <strong id="status">กำลังเริ่มต้น...</strong></p>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const statusEl = document.getElementById('status');
      statusEl.textContent = 'หน้าเว็บพร้อมแล้ว, กำลังเรียก liff.init()...';

      // 2. เริ่มต้น LIFF ด้วย ID ของคุณ
      liff.init({ liffId: "2008248434-1k7bSQPa" })
        .then(() => {
          statusEl.textContent = 'liff.init() สำเร็จ!';
          alert('SUCCESS: liff.init() ทำงานสำเร็จ!');

          // 3. ตรวจสอบสถานะล็อกอิน
          if (liff.isLoggedIn()) {
            statusEl.textContent = 'สถานะ: ล็อกอินแล้ว, กำลังดึงโปรไฟล์...';
            return liff.getProfile();
          } else {
            statusEl.textContent = 'สถานะ: ยังไม่ได้ล็อกอิน';
            alert('ERROR: LIFF บอกว่ายังไม่ได้ล็อกอิน');
          }
        })
        .then(profile => {
          // 4. ถ้าดึงโปรไฟล์สำเร็จ
          if (profile) {
            statusEl.textContent = 'ดึงโปรไฟล์สำเร็จ! User ID: ' + profile.userId;
            alert('SUCCESS: ได้โปรไฟล์แล้ว! ชื่อ: ' + profile.displayName);
          }
        })
        .catch(err => {
          // 5. หากมีข้อผิดพลาดเกิดขึ้น
          console.error(err);
          statusEl.textContent = 'เกิดข้อผิดพลาด: ' + JSON.stringify(err);
          alert('CATCH ERROR: ' + JSON.stringify(err));
        });
    });
  </script>
</body>
</html>
